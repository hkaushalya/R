{
    "contents" : "#study delay times \n#rm(list=ls())\n\nsetwd('~/Documents/Personal/Samantha/LearningMaterials/IntroToR/RandomExercises/AirlinePerformanceAnalysis')\n\n#========================================\n# This function produces the mean \n# arrival/departure times by month\n# for the given years\n#========================================\ndelayByMonth<-function(years) {\n  \n  for (yr in years) {\n    print(yr)\n    datafile <- paste0('data/',yr,'.Rda')\n    load(datafile)\n    \n    #library(psych)\n    #str(airtimes)\n    #summary(airtimes)\n    #describeBy(airtimes,airtimes$Month)\n    \n    #system.time(meanArrDelByMonth <- aggregate(airtimes$DepDelay, by=list(airtimes$Month), FUN=mean, na.rm=T))\n    #meanDepDelByMonth <- aggregate(airtimes$ArrDelay, by=list(airtimes$Month), FUN=mean, na.rm=T)\n    #This will not use multiple cores, but will be extremely fast and memory efficient.\n    library(data.table)\n    DT <- data.table(airtimes)\n    rm(airtimes)\n    setkey(DT, Month)\n    meanDepDelByMonth<-DT[, list(DepDelay = mean(DepDelay, na.rm=TRUE)), by = Month]\n    meanArrDelByMonth<-DT[, list(ArrDelay = mean(ArrDelay, na.rm=TRUE)), by = Month]\n    \n    col.arr <- 'deepskyblue2'\n    col.dep <- 'tomato'\n    pch.all <- 16\n    lwd.all <- 2\n    \n    filename <- paste0('figures/delayByMonthFor_',yr,'.pdf')\n    pdf(filename)\n    plot(meanArrDelByMonth,type='p', col=col.arr, \n         main=paste0('Mean Arrival/Departure Delay by Month for the Year ', yr), \n         xlab='Month', ylab='Mean (Minutes)', \n         ylim=c(-2,20),pch=pch.all)\n    lines(meanArrDelByMonth, col=col.arr ,lwd=lwd.all)\n    lines(meanDepDelByMonth, type='p', col=col.dep,pch=pch.all)\n    lines(meanDepDelByMonth, col=col.dep, lwd=lwd.all)\n    legend(\"bottomleft\", legend=list(\"Departure\",\"Arrival\"), \n           pch = pch.all, col=c(col.dep, col.arr),\n           border=\"white\", lwd=lwd.all,\n           box.lwd = 0)\n    lines(x=1:12,y=rep(mean(meanArrDelByMonth$ArrDelay),12),col=col.arr, lwd=lwd.all)\n    lines(x=1:12,y=rep(mean(meanDepDelByMonth$DepDelay),12),col=col.dep, lwd=lwd.all)\n    \n    dev.off()\n    rm(list=ls())\n  }\n}\n\n\n#=============================================\n# This function overlays the mean \n# arrival or departure times by month\n# for all years\n#=============================================\ndelayByMonthOverylaid<-function(years) {\n  \n  Month <- c(1:12)\n  #Month <- month.name\n  df.arr <- data.frame(Month)\n  df.dep <- data.frame(Month)\n  \n  for (yr in years) {\n    i <- 1\n    print(yr)\n    datafile <- paste0('data/',yr,'.Rda')\n    load(datafile)\n    \n    library(data.table)\n    DT <- data.table(airtimes)\n    rm(airtimes)\n    setkey(DT, Month)\n    meanDepDelByMonth<-DT[, list(DepDelay = mean(DepDelay, na.rm=TRUE)), by = Month]\n    meanArrDelByMonth<-DT[, list(ArrDelay = mean(ArrDelay, na.rm=TRUE)), by = Month]\n\n    arr.old.names <- names(meanArrDelByMonth)\n    dep.old.names <- names(meanDepDelByMonth)\n    #arr.new.names <- c('Month',paste0('DepDelay.',yr), paste0('ArrDelay.', yr))\n    arr.new.names <- c('Month',paste0('yr',yr))\n    dep.new.names <- c('Month',paste0('yr',yr))\n    setnames(meanArrDelByMonth, arr.old.names, arr.new.names)\n    setnames(meanDepDelByMonth, dep.old.names, dep.new.names)\n    \n    df.arr <- merge(df.arr, meanArrDelByMonth, by='Month')\n    df.dep <- merge(df.dep, meanDepDelByMonth, by='Month')\n    rm(meanArrDelByMonth, meanDepDelByMonth)\n    rm(DT, arr.old.names, dep.old.names, arr.new.names, dep.new.names)\n  }\n  \n  df.arr\n  df.dep\n  \n  col.arr <- 2\n  col.dep <- 'tomato'\n  pch.all <- 16\n  lwd.all <- 2\n  \n  filename <- paste0('figures/ArrivalDelayByMonth_all.pdf')\n  pdf(filename)\n  i <- 2\n  leg.text <- list()\n  for (yr in years) {\n    if (i==2) {\n      plot(x=df.arr$Month, y=df.arr[,i], type='l', col=i, \n           main='Mean Arrival Delay by Month 1988-2008', \n           xlab='Month', ylab='Mean (Minutes)', \n           ylim=c(-2,30),pch=pch.all)\n    } else {\n      lines(df.arr[,i], col=i, lwd=lwd.all)\n    }\n    i <- i + 1\n  }\n # legend(\"bottomleft\", legend=list(\"Departure\",\"Arrival\"), \n#         pch=pch.all, col=i,\n#         border=\"white\", lwd=lwd.all,\n#         box.lwd = 0)\n  \n  dev.off()\n  rm(list=ls())\n}\n\n#=============================================\n########################################\n# Calculate mean delay for a given airport \n# arrival or departure times by month\n# for all years\n########################################\ndelayByOriginAirport<-function(years, airport) {\n  \n  Origin <- c(1:12)\n  #Origin <- Origin.name\n  df.arr <- data.frame(Origin)\n  df.dep <- data.frame(Origin)\n  yr <- 2008\n  for (yr in years) {\n    i <- 1\n    print(yr)\n    datafile <- paste0('data/',yr,'.Rda')\n    load(datafile)\n    \n    library(data.table)\n    DT <- data.table(airtimes)\n    rm(airtimes)\n    setkey(DT,Origin) \n    meanDepDelByOrigin<-DT[, list(DepDelay = mean(DepDelay, na.rm=TRUE)), by = Origin]\n    meanArrDelByOrigin<-DT[, list(ArrDelay = mean(ArrDelay, na.rm=TRUE)), by = Origin]\n    \n    arr.old.names <- names(meanArrDelByOrigin)\n    dep.old.names <- names(meanDepDelByOrigin)\n    #arr.new.names <- c('Origin',paste0('DepDelay.',yr), paste0('ArrDelay.', yr))\n    arr.new.names <- c('Origin',paste0('yr',yr))\n    dep.new.names <- c('Origin',paste0('yr',yr))\n    setnames(meanArrDelByOrigin, arr.old.names, arr.new.names)\n    setnames(meanDepDelByOrigin, dep.old.names, dep.new.names)\n    \n    df.arr <- merge(df.arr, meanArrDelByOrigin, by='Origin')\n    df.dep <- merge(df.dep, meanDepDelByOrigin, by='Origin')\n    rm(meanArrDelByOrigin, meanDepDelByOrigin)\n    rm(DT, arr.old.names, dep.old.names, arr.new.names, dep.new.names)\n  }\n  \n  df.arr\n  df.dep\n  \n  col.arr <- 2\n  col.dep <- 'tomato'\n  pch.all <- 16\n  lwd.all <- 2\n  \n  filename <- paste0('figures/ArrivalDelayByOrigin_all.pdf')\n  pdf(filename)\n  i <- 2\n  leg.text <- list()\n  for (yr in years) {\n    if (i==2) {\n      plot(x=df.arr$Origin, y=df.arr[,i], type='l', col=i, \n           main='Mean Arrival Delay by Origin 1988-2008', \n           xlab='Origin', ylab='Mean (Minutes)', \n           ylim=c(-2,30),pch=pch.all)\n    } else {\n      lines(df.arr[,i], col=i, lwd=lwd.all)\n    }\n    i <- i + 1\n  }\n  # legend(\"bottomleft\", legend=list(\"Departure\",\"Arrival\"), \n  #         pch=pch.all, col=i,\n  #         border=\"white\", lwd=lwd.all,\n  #         box.lwd = 0)\n  \n  dev.off()\n  rm(list=ls())\n}\n\n\n#x <- c(1:10)\n#p <- plot(x,type=\"n\")\n#q <- lines(c(10:20))\n\n#delayByMonth(c(1987:2008))\ndelayByMonthOverylaid(c(1988:2008))",
    "created" : 1384988080600.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "10|31|56|0|\n64|40|128|0|\n",
    "hash" : "151107265",
    "id" : "5F64A30D",
    "lastKnownWriteTime" : 1386863059,
    "path" : "~/Documents/Personal/Samantha/LearningMaterials/IntroToR/RandomExercises/AirlinePerformanceAnalysis/rawcode/delays.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}